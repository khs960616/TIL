## DNS
사전적 정의 : 도메인 네임 시스템(Domain Name System, DNS)은 호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행할 수 있도록 하기 위해 개발되었다

--- 

## 유저 코드 관점에서의 DNS 호출

DNS 리졸버 : DNS서버의 클라이언트로써, DNS서버에게 도메인 주소를 보내고,  그에 대응되는 IP조사를 조사하는 (name resolution을 실행) 클라이언트

-> 소켓 라이브러리에서 해당 기능을 지원한다. 

---
## 소켓 라이브러리에서 DNS의 동작 과정 
1. 네트워크 어플리케이션에서  getHostByName("도메인명"); 형태의 메서드를 호출하면, 소켓 라이브러리에서 DNS리졸버가 동작하여, DNS서버로 부터 IP주소를 가져온다.
  (이때 유저모드에서 실행 중이던 해당 어플리케이션은 잠시 정지한다.)
  
2. 어플리케이션에서 해당 메서드를 호출하게 되면, DNS 리졸버에게 제어권이 넘어가게 되고, DNS 리졸버는  DNS 서버로 전송할 메시지를 가공하고, 전달하기 위해 시스템콜을 호출하게 된다.
(일반적으로 네트워크 프로그래밍 관련된, 유저모드에서 호출하는 함수는 시스템콜을 래핑한 형태이다.)

3. 시스템콜이 호출되게 되면 유저모드에서 커널모드로 스위칭이 일어나게 된다. 이후 커널모드에서 OS 내부에 포함된 프로토콜 스택을 호출하여, 네트워크로 데이터를 송수신 작업을한다. 
     
4. 프로토콜 스택을 통해 데이터 송수신이 끝나면, 커널모드는 리졸버에게 네트워크 응답 메시지를 전달하고, 리졸버는 메시지 중 ip주소를 추출하여 애플리케이션 프로그램에게 전달하게 된다. 

---

## DNS의 계층적 구조 

```
DNS서버는 일반적으로 계층 구조를 이루고 있다. 
ex) www.naver.com  -> 이면 com 하위의 naver 하위의 www.. 이런 형태로 계층적인 구조를 이루고 있다.  
     //또한 com, kr 등의 상위에는 또 하나의 "루트 도메인"이 존재한다.
```
(루트 도메인은 전세계적으로 13개 정도의 제한적인 IP주소를 가지며 잘 변화하지 않는다.)
(실제로는 복수의 서버기계가 마치 하나의 서버 기계인 것 처럼 동작한다.) 

---

### DNS 요청 과정

1. DNS 요청을 하는 도메인에 대해서, 캐싱되어있는 정보가 있는지 확인한 후, 없다면 가장 가까운 DNS서버에 요청을 전달하게 된다.
2. 요청을 받은 DNS서버는 현재 자신의 서버에 요청이 들어온 도메인에 대한 IP주소가 캐싱 되어있는지 확인하고, 없다면 루트 도메인으로  DNS 요청을 보내게 된다.
3. 루트 도메인은 해당 도메인 정보가 캐싱되어있는지 확인하고, 만일 없다면 하위 도메인의 주소를 반환하게 된다.
4. 하위 도메인주소를 받으면, 해당 주소를 캐싱하고, 원하는 주소를 얻기 위해 2~3번의 과정을 반복하여 수행하게 된다.

